/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 15.1 		*/
/*  Created On : 21-Dec-2020 5:53:50 PM 				*/
/*  DBMS       : MySql 						*/
/* ---------------------------------------------------- */

DROP DATABASE IF EXISTS ist176180;
CREATE DATABASE ist176180;
USE ist176180;

SET FOREIGN_KEY_CHECKS=0; 
/* Drop Tables */

DROP TABLE IF EXISTS `BOSS` CASCADE;
DROP TABLE IF EXISTS `CHARACTERS` CASCADE;
DROP TABLE IF EXISTS `DR` CASCADE;
DROP TABLE IF EXISTS `Drops` CASCADE;
DROP TABLE IF EXISTS `Finds` CASCADE;
DROP TABLE IF EXISTS `GBelongs` CASCADE;
DROP TABLE IF EXISTS `GROUP` CASCADE;
DROP TABLE IF EXISTS `GUILD` CASCADE;
DROP TABLE IF EXISTS `ITEM` CASCADE;
DROP TABLE IF EXISTS `Raids` CASCADE;
DROP TABLE IF EXISTS `RBelongs` CASCADE;

/* Create Tables */

CREATE TABLE `BOSS`
(`BOSS_name` VARCHAR(255) NOT NULL,
`BOSS_HP` INT NULL,	
CONSTRAINT `PK_BOSS` PRIMARY KEY (`BOSS_name` ASC));

CREATE TABLE `CHARACTERS`
(`CHAR_name` VARCHAR(255) NOT NULL,
 `CHAR_class` VARCHAR(255) NULL,
 `CHAR_race` VARCHAR(255) NULL,
 `CHAR_AP` INT NULL,
 `CHAR_role` VARCHAR(255) NULL,
 `CHAR_level` INT NULL,	
 `CHAR_prof1` VARCHAR(255) NULL,	
 `CHAR_prof2` VARCHAR(255) NULL,
 `CHAR_GS` INT NULL,	CONSTRAINT `PK_CHARACTERS` PRIMARY KEY (`CHAR_name` ASC));

CREATE TABLE `DR`
(`DR_name` VARCHAR(255) NOT NULL,
 `DR_nbosses` INT NULL,	
 `DR_location` VARCHAR(255) NULL, CONSTRAINT `PK_DR` PRIMARY KEY (`DR_name` ASC));

CREATE TABLE `Drops`
(	`BOSS_name` VARCHAR(255) NOT NULL,
	`ITEM_name` VARCHAR(255) NOT NULL,
	`Drop_chance` INT NULL,
	CONSTRAINT `PK_Drops` PRIMARY KEY (`BOSS_name` ASC, `ITEM_name` ASC));

CREATE TABLE `Finds`
(	`CHAR_name` VARCHAR(255) NOT NULL,
	`GROUP_leader` VARCHAR(255) NOT NULL,
	CONSTRAINT `PK_Finds` PRIMARY KEY (`CHAR_name` ASC, `GROUP_leader` ASC));

CREATE TABLE `GBelongs`
(	`DKP` INT NULL,
	`rank` VARCHAR(255) NULL,
	`GUILD_name` VARCHAR(255) NOT NULL,
	`CHAR_name` VARCHAR(255) NOT NULL,	CONSTRAINT `PK_GBelongs` PRIMARY KEY (`GUILD_name` ASC, `CHAR_name` ASC));

CREATE TABLE `GROUP`
(	`GROUP_leader` VARCHAR(255) NOT NULL,
	`GROUP_size` VARCHAR(255) NULL,
	`GROUP_GSreq` INT NULL,
	CONSTRAINT `PK_GROUP` PRIMARY KEY (`GROUP_leader` ASC));

CREATE TABLE `GUILD`
(	`GUILD_name` VARCHAR(255) NOT NULL,
	`Leader` VARCHAR(255) NULL,
	`Size` INT NULL,CONSTRAINT `PK_GUILD` PRIMARY KEY (`GUILD_name` ASC));

CREATE TABLE `ITEM`
(	`ITEM_name` VARCHAR(255) NOT NULL,
	`ITEM_level` INT NULL,
	`ITEM_slot` VARCHAR(255) NULL,
	`ITEM_type` VARCHAR(255) NULL,	CONSTRAINT `PK_ITEM` PRIMARY KEY (`ITEM_name` ASC));

CREATE TABLE `Raids`
(	`GROUP_leader` VARCHAR(255) NOT NULL,
	`DR_name` VARCHAR(255) NOT NULL,
	`ID` INT NULL,	CONSTRAINT `PK_Raids` PRIMARY KEY (`GROUP_leader` ASC, `DR_name` ASC));

CREATE TABLE `RBelongs`
(	`DR_name` VARCHAR(255) NOT NULL,
	`BOSS_name` VARCHAR(255) NOT NULL,
	CONSTRAINT `PK_RBelongs` PRIMARY KEY (`DR_name` ASC, `BOSS_name` ASC));

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE `Drops` 
 ADD INDEX `IXFK_Drops_BOSS` (`BOSS_name` ASC)
;

ALTER TABLE `Drops` 
 ADD INDEX `IXFK_Drops_ITEM` (`ITEM_name` ASC)
;

ALTER TABLE `Finds` 
 ADD INDEX `IXFK_Finds_CHARACTERS` (`CHAR_name` ASC)
;

ALTER TABLE `Finds` 
 ADD INDEX `IXFK_Finds_GROUP` (`GROUP_leader` ASC)
;

ALTER TABLE `GBelongs` 
 ADD INDEX `IXFK_GBelongs_CHARACTERS` (`CHAR_name` ASC)
;

ALTER TABLE `GBelongs` 
 ADD INDEX `IXFK_GBelongs_GUILD` (`GUILD_name` ASC)
;

ALTER TABLE `Raids` 
 ADD INDEX `IXFK_Raids_DR` (`DR_name` ASC)
;

ALTER TABLE `Raids` 
 ADD INDEX `IXFK_Raids_GROUP` (`GROUP_leader` ASC)
;

ALTER TABLE `RBelongs` 
 ADD INDEX `IXFK_RBelongs_BOSS` (`BOSS_name` ASC)
;

ALTER TABLE `RBelongs` 
 ADD INDEX `IXFK_RBelongs_DR` (`DR_name` ASC)
;

/* Create Foreign Key Constraints */

ALTER TABLE `Drops` 
	ADD CONSTRAINT `FK_Drops_BOSS`
	FOREIGN KEY (`BOSS_name`) REFERENCES `BOSS` (`BOSS_name`) ON DELETE Restrict ON UPDATE Restrict;

ALTER TABLE `Drops` 
	ADD CONSTRAINT `FK_Drops_ITEM`
	FOREIGN KEY (`ITEM_name`) REFERENCES `ITEM` (`ITEM_name`) ON DELETE Restrict ON UPDATE Restrict;

ALTER TABLE `Finds` 
	ADD CONSTRAINT `FK_Finds_CHARACTERS`
	FOREIGN KEY (`CHAR_name`) REFERENCES `CHARACTERS` (`CHAR_name`) ON DELETE Restrict ON UPDATE Restrict;

ALTER TABLE `Finds` 
	ADD CONSTRAINT `FK_Finds_GROUP`
	FOREIGN KEY (`GROUP_leader`) REFERENCES `GROUP` (`GROUP_leader`) ON DELETE Restrict ON UPDATE Restrict;

ALTER TABLE `GBelongs` 
	ADD CONSTRAINT `FK_GBelongs_CHARACTERS`
	FOREIGN KEY (`CHAR_name`) REFERENCES `CHARACTERS` (`CHAR_name`) ON DELETE Restrict ON UPDATE Restrict;

ALTER TABLE `GBelongs` 
	ADD CONSTRAINT `FK_GBelongs_GUILD`
	FOREIGN KEY (`GUILD_name`) REFERENCES `GUILD` (`GUILD_name`) ON DELETE Restrict ON UPDATE Restrict;

ALTER TABLE `Raids`
	ADD CONSTRAINT `FK_Raids_DR`
	FOREIGN KEY (`DR_name`) REFERENCES `DR` (`DR_name`) ON DELETE Restrict ON UPDATE Restrict;

ALTER TABLE `Raids` 
	ADD CONSTRAINT `FK_Raids_GROUP`
	FOREIGN KEY (`GROUP_leader`) REFERENCES `GROUP` (`GROUP_leader`) ON DELETE Restrict ON UPDATE Restrict;

ALTER TABLE `RBelongs` 
	ADD CONSTRAINT `FK_RBelongs_BOSS`
	FOREIGN KEY (`BOSS_name`) REFERENCES `BOSS` (`BOSS_name`) ON DELETE Restrict ON UPDATE Restrict;

ALTER TABLE `RBelongs` 
	ADD CONSTRAINT `FK_RBelongs_DR`
	FOREIGN KEY (`DR_name`) REFERENCES `DR` (`DR_name`) ON DELETE Restrict ON UPDATE Restrict;

SET FOREIGN_KEY_CHECKS=1
; 